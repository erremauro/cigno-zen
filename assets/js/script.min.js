(function(v){console.log("[cigno-zen] script loaded!");function g(b){var m=v.getElementById("search-bar");m.style.display==="none"||m.style.display===""?m.style.display="block":m.style.display="none",v.querySelectorAll(".menu-label").forEach(E=>E.classList.toggle("hidden"));var L=v.getElementById("menu-button");L.classList.toggle("rotated")}v.addEventListener("DOMContentLoaded",function(){var b=v.getElementById("site-menu-toggle");b.addEventListener("click",g)})})(document),function(){function v(n,s){return(s||document).querySelector(n)}function g(n,s){return Array.prototype.slice.call((s||document).querySelectorAll(n))}function b(n){var s=n.getAttribute("data-toggle-target")||"#"+(n.getAttribute("aria-controls")||"").trim();if(!s)return null;try{return document.querySelector(s)}catch{return null}}function m(n){var s=(n.getAttribute("data-scroll-target")||"").trim();if(!s)return null;try{return document.querySelector(s)}catch{return null}}function L(n,s){var f=n.querySelector(".more-link-button"),d=n.querySelector(".more-link-lable-top"),h=n.querySelector(".more-link-lable-bottom");n.setAttribute("aria-expanded",String(s)),f&&f.classList.toggle("rotated",s),d&&d.classList.toggle("hidden",s),h&&h.classList.toggle("hidden",!s);var y=b(n);y&&(s?y.removeAttribute("hidden"):y.setAttribute("hidden",""))}function E(n){if(!(!n||!("scrollIntoView"in n)))try{n.scrollIntoView({behavior:"smooth",block:"start"})}catch{n.scrollIntoView(!0)}}function A(n){n&&n.preventDefault();var s=n.currentTarget,f=s.getAttribute("aria-expanded")!=="true";L(s,f);var d=s.getAttribute("data-toggle-target")||"#"+(s.getAttribute("aria-controls")||"").trim();if(d&&g(".js-toggle").forEach(function(u){if(u!==s){var w=u.getAttribute("data-toggle-target")||"#"+(u.getAttribute("aria-controls")||"").trim();w===d&&L(u,f)}}),!f){var h=m(s);if(!h&&d){var y=g(".js-toggle").find(function(u){if(u===s)return!1;var w=u.getAttribute("data-toggle-target")||"#"+(u.getAttribute("aria-controls")||"").trim();return w===d&&u.hasAttribute("data-scroll-target")});y&&(h=m(y))}h&&E(h)}}function k(n){(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),A(n))}document.addEventListener("DOMContentLoaded",function(){g(".js-toggle").forEach(function(n){L(n,!1),n.addEventListener("click",A),n.addEventListener("keydown",k)})})}(),(()=>{const v=(t,o=document)=>Array.from(o.querySelectorAll(t)),g=(t,o=document)=>o.querySelector(t),b=t=>window.CSS&&CSS.escape?CSS.escape(t):t.replace(/[^a-zA-Z0-9_\-]/g,"\\$&"),m=t=>{try{const o=t&&t.includes("#")?t.split("#").pop():"";return decodeURIComponent((o||"").trim())}catch{return""}},L=(t,o)=>{const e=r=>{if(r.nodeType!==1)return!1;const l=(r.textContent||"").trim();if(!/^\[?\(?\d+\)?[\.\:\]]?$/.test(l))return!1;if(r.tagName==="A"){const a=(r.getAttribute("href")||"").trim(),p=r.className||"";if(a.includes("#")){const S=a.split("#").pop();if(S===o||/fnref|ref|note/i.test(S)||/fnref|ref|note/i.test(p))return!0}return!1}return["SUP","SPAN","EM","STRONG"].includes(r.tagName)};let i=3;for(;t.firstChild&&i-- >0;){const r=t.firstChild;if(e(r)){t.removeChild(r);continue}break}},E=t=>{Array.from(t.querySelectorAll("a")).forEach(e=>{const i=e.getAttribute("href")||"",r=e.className||"",l=e.getAttribute("role")||"",c=(e.getAttribute("aria-label")||e.getAttribute("title")||"").toLowerCase(),a=(e.textContent||"").replace(/[\uFE0E\uFE0F]/g,"").trim(),p=i.includes("#"),S=p?i.split("#").pop():"",T=/fnref|footnote.*ref|reversefootnote/i.test(r)||/fnref|footnote.*ref|back|return/i.test(S),M=/backref|return|footnote[-_]?return/i.test(r)||l.toLowerCase()==="doc-backlink"||c.includes("back")||c.includes("ritorna")||c.includes("torna"),N=/↩|↪|↑|⬆/.test(a);(p&&(T||M)||N)&&e.remove()})},A=t=>{let o=document.querySelector(`p.footnote#${b(t)}`);if(!o){const c=document.getElementById(t);c&&(o=c.matches("p.footnote")?c:c.querySelector("p.footnote, p"))}if(!o)return"";const e=o.cloneNode(!0);E(e);const i=e.innerHTML.trim(),r=o.cloneNode(!0);return L(r,t),E(r),(r.textContent.trim()?r.innerHTML.trim():i)||i},k=(t,o)=>{const e=r=>{const l=(r||"").trim(),c=l.match(/^\s*[\[\(]?(\d+)[\]\)\.:]?\s*$/);return c?c[1]:l};let i=e(t.textContent||t.innerText||"");if((!i||!/^\d+$/.test(i))&&t.closest("sup")&&(i=e(t.closest("sup").textContent||"")),!i||!/^\d+$/.test(i)){const r=(o||"").match(/(\d+)(?!.*\d)/);i=r?r[1]:i||o||""}return i};let n={anchor:null,popup:null,overlay:null};const s=()=>{var t,o,e,i;(t=n.popup)==null||t.remove(),(o=n.overlay)==null||o.remove(),(i=(e=n.anchor)==null?void 0:e.focus)==null||i.call(e,{preventScroll:!0}),n={anchor:null,popup:null,overlay:null},document.removeEventListener("keydown",f),window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)},f=t=>{t.key==="Escape"&&s()},d=()=>{n.popup&&n.anchor&&u(n.popup,n.anchor)},h=(t,o)=>{const e=document.createElement("div");e.className="footnote-overlay",e.addEventListener("click",s,{passive:!0});const i=document.createElement("div");i.className="footnote-popup",i.setAttribute("role","dialog");const r=`footnote-popup-title-${Date.now().toString(36)}-${Math.random().toString(36).slice(2,7)}`;i.setAttribute("aria-labelledby",r),i.setAttribute("aria-modal","true");const l=document.createElement("button");l.className="footnote-popup-close",l.type="button",l.setAttribute("aria-label","Chiudi nota"),l.innerHTML="\xD7",l.addEventListener("click",s);const c=document.createElement("div");c.className="footnote-popup-title",c.id=r,c.textContent=`${o}`;const a=document.createElement("div");return a.className="footnote-popup-content",a.innerHTML=t,i.appendChild(l),i.appendChild(c),i.appendChild(a),{popup:i,overlay:e}},y=680,u=(t,o)=>{t.style.minWidth="240px",t.style.visibility="hidden",t.style.left="0px",t.style.top="0px",document.body.appendChild(t);const e=o.getBoundingClientRect(),i=document.documentElement.clientWidth,r=document.documentElement.clientHeight,l=8,c=t.getBoundingClientRect();let a=window.scrollY+e.bottom+l;e.bottom+c.height+l>r&&(a=window.scrollY+e.top-c.height-l,a<window.scrollY+l&&(a=window.scrollY+l));let p=window.scrollX+e.left+(e.width-c.width)/2;p=Math.max(window.scrollX+l,Math.min(p,window.scrollX+i-c.width-l)),t.style.left=`${p}px`,t.style.top=`${a}px`,t.style.visibility="visible",i<=y&&(t.style.right=`${p}px`)},w=(t,o)=>{const e=A(o);if(!e)return;const i=k(t,o);s();const{popup:r,overlay:l}=h(e,i);document.body.appendChild(l),n={anchor:t,popup:r,overlay:l},u(r,t),document.addEventListener("keydown",f),window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),(r.querySelector("button")||r).focus({preventScroll:!0})},q=()=>{document.addEventListener("click",t=>{if(t.metaKey||t.ctrlKey||t.shiftKey||t.button===1)return;const o=t.target.closest("sup a[href], a.footnote-ref[href]");if(!o)return;const e=m(o.getAttribute("href")||"");!e||!(document.querySelector(`p.footnote#${b(e)}`)||document.getElementById(e))||(t.preventDefault(),w(o,e))})},x=()=>{const t=g("div.footnotes"),o=g("#footnotes-toggle");if(!o||!t)return;t.classList.add("hidden"),o.setAttribute("role","button"),o.setAttribute("tabindex","0"),o.setAttribute("aria-expanded","false");let e=g(".footnotes-toggle-chevron",o);e?e.style.transform="rotate(-90deg)":(e=document.createElement("img"),e.className="footnotes-toggle-chevron",e.src="/wp-content/themes/cigno-zen/assets/images/chevron-down.svg",e.width="32",e.height="32",e.alt="",e.setAttribute("aria-hidden","true"),e.style.transform="rotate(-90deg)",e.style.marginLeft="0.5rem",o.appendChild(e));const i=r=>{o.setAttribute("aria-expanded",r?"true":"false"),r?(t.classList.remove("hidden"),e.style.transform=""):(t.classList.add("hidden"),e.style.transform="rotate(-90deg)")};o.addEventListener("click",()=>i(t.classList.contains("hidden"))),o.addEventListener("keydown",r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),i(t.classList.contains("hidden")))})},C=()=>{x(),q()};document.readyState!=="loading"?C():document.addEventListener("DOMContentLoaded",C)})();
//# sourceMappingURL=script.min.js.map
