(function(v){console.log("[cigno-zen] script loaded!");function m(c){var d=v.getElementById("search-bar");d.style.display==="none"||d.style.display===""?d.style.display="block":d.style.display="none",v.querySelectorAll(".menu-label").forEach(L=>L.classList.toggle("hidden"));var p=v.getElementById("menu-button");p.classList.toggle("rotated")}v.addEventListener("DOMContentLoaded",function(){var c=v.getElementById("site-menu-toggle");c.addEventListener("click",m)})})(document),function(){function v(n,s){return(s||document).querySelector(n)}function m(n,s){return Array.prototype.slice.call((s||document).querySelectorAll(n))}function c(n){var s=n.getAttribute("data-toggle-target")||"#"+(n.getAttribute("aria-controls")||"").trim();if(!s)return null;try{return document.querySelector(s)}catch{return null}}function d(n){var s=(n.getAttribute("data-scroll-target")||"").trim();if(!s)return null;try{return document.querySelector(s)}catch{return null}}function p(n,s){var u=n.querySelector(".more-link-button"),g=n.querySelector(".more-link-lable-top"),y=n.querySelector(".more-link-lable-bottom");n.setAttribute("aria-expanded",String(s)),u&&u.classList.toggle("rotated",s),g&&g.classList.toggle("hidden",s),y&&y.classList.toggle("hidden",!s);var E=c(n);E&&(s?E.removeAttribute("hidden"):E.setAttribute("hidden",""))}function L(n){if(!(!n||!("scrollIntoView"in n)))try{n.scrollIntoView({behavior:"smooth",block:"start"})}catch{n.scrollIntoView(!0)}}function w(n){n&&n.preventDefault();var s=n.currentTarget,u=s.getAttribute("aria-expanded")!=="true";p(s,u);var g=s.getAttribute("data-toggle-target")||"#"+(s.getAttribute("aria-controls")||"").trim();if(g&&m(".js-toggle").forEach(function(h){if(h!==s){var A=h.getAttribute("data-toggle-target")||"#"+(h.getAttribute("aria-controls")||"").trim();A===g&&p(h,u)}}),!u){var y=d(s);if(!y&&g){var E=m(".js-toggle").find(function(h){if(h===s)return!1;var A=h.getAttribute("data-toggle-target")||"#"+(h.getAttribute("aria-controls")||"").trim();return A===g&&h.hasAttribute("data-scroll-target")});E&&(y=d(E))}y&&L(y)}}function k(n){(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),w(n))}document.addEventListener("DOMContentLoaded",function(){m(".js-toggle").forEach(function(n){p(n,!1),n.addEventListener("click",w),n.addEventListener("keydown",k)})})}(),(()=>{const v=(t,o=document)=>Array.from(o.querySelectorAll(t)),m=(t,o=document)=>o.querySelector(t),c=t=>window.CSS&&CSS.escape?CSS.escape(t):t.replace(/[^a-zA-Z0-9_\-]/g,"\\$&"),d=t=>{try{const o=t&&t.includes("#")?t.split("#").pop():"";return decodeURIComponent((o||"").trim())}catch{return""}},p=(t,o)=>{const e=r=>{if(r.nodeType!==1)return!1;const a=(r.textContent||"").trim();if(!/^\[?\(?\d+\)?[\.\:\]]?$/.test(a))return!1;if(r.tagName==="A"){const f=(r.getAttribute("href")||"").trim(),b=r.className||"";if(f.includes("#")){const S=f.split("#").pop();if(S===o||/fnref|ref|note/i.test(S)||/fnref|ref|note/i.test(b))return!0}return!1}return["SUP","SPAN","EM","STRONG"].includes(r.tagName)};let i=3;for(;t.firstChild&&i-- >0;){const r=t.firstChild;if(e(r)){t.removeChild(r);continue}break}},L=t=>{Array.from(t.querySelectorAll("a")).forEach(e=>{const i=e.getAttribute("href")||"",r=e.className||"",a=e.getAttribute("role")||"",l=(e.getAttribute("aria-label")||e.getAttribute("title")||"").toLowerCase(),f=(e.textContent||"").replace(/[\uFE0E\uFE0F]/g,"").trim(),b=i.includes("#"),S=b?i.split("#").pop():"",x=/fnref|footnote.*ref|reversefootnote/i.test(r)||/fnref|footnote.*ref|back|return/i.test(S),M=/backref|return|footnote[-_]?return/i.test(r)||a.toLowerCase()==="doc-backlink"||l.includes("back")||l.includes("ritorna")||l.includes("torna"),I=/↩|↪|↑|⬆/.test(f);(b&&(x||M)||I)&&e.remove()})},w=t=>{let o=document.querySelector(`p.footnote#${c(t)}`);if(!o){const l=document.getElementById(t);l&&(o=l.matches("p.footnote")?l:l.querySelector("p.footnote, p"))}if(!o)return"";const e=o.cloneNode(!0);L(e);const i=e.innerHTML.trim(),r=o.cloneNode(!0);return p(r,t),L(r),(r.textContent.trim()?r.innerHTML.trim():i)||i},k=(t,o)=>{const e=r=>{const a=(r||"").trim(),l=a.match(/^\s*[\[\(]?(\d+)[\]\)\.:]?\s*$/);return l?l[1]:a};let i=e(t.textContent||t.innerText||"");if((!i||!/^\d+$/.test(i))&&t.closest("sup")&&(i=e(t.closest("sup").textContent||"")),!i||!/^\d+$/.test(i)){const r=(o||"").match(/(\d+)(?!.*\d)/);i=r?r[1]:i||o||""}return i};let n={anchor:null,popup:null,overlay:null};const s=()=>{var t,o,e,i;(t=n.popup)==null||t.remove(),(o=n.overlay)==null||o.remove(),(i=(e=n.anchor)==null?void 0:e.focus)==null||i.call(e,{preventScroll:!0}),n={anchor:null,popup:null,overlay:null},document.removeEventListener("keydown",u),window.removeEventListener("resize",g),window.removeEventListener("scroll",g,!0)},u=t=>{t.key==="Escape"&&s()},g=()=>{n.popup&&n.anchor&&h(n.popup,n.anchor)},y=(t,o)=>{const e=document.createElement("div");e.className="footnote-overlay",e.addEventListener("click",s,{passive:!0});const i=document.createElement("div");i.className="footnote-popup",i.setAttribute("role","dialog");const r=`footnote-popup-title-${Date.now().toString(36)}-${Math.random().toString(36).slice(2,7)}`;i.setAttribute("aria-labelledby",r),i.setAttribute("aria-modal","true");const a=document.createElement("button");a.className="footnote-popup-close",a.type="button",a.setAttribute("aria-label","Chiudi nota"),a.innerHTML="\xD7",a.addEventListener("click",s);const l=document.createElement("div");l.className="footnote-popup-title",l.id=r,l.textContent=`${o}`;const f=document.createElement("div");return f.className="footnote-popup-content",f.innerHTML=t,i.appendChild(a),i.appendChild(l),i.appendChild(f),{popup:i,overlay:e}},E=680,h=(t,o)=>{t.style.minWidth="240px",t.style.visibility="hidden",t.style.left="0px",t.style.top="0px",document.body.appendChild(t);const e=o.getBoundingClientRect(),i=document.documentElement.clientWidth,r=document.documentElement.clientHeight,a=8,l=t.getBoundingClientRect();let f=window.scrollY+e.bottom+a;e.bottom+l.height+a>r&&(f=window.scrollY+e.top-l.height-a,f<window.scrollY+a&&(f=window.scrollY+a));let b=window.scrollX+e.left+(e.width-l.width)/2;b=Math.max(window.scrollX+a,Math.min(b,window.scrollX+i-l.width-a)),t.style.left=`${b}px`,t.style.top=`${f}px`,t.style.visibility="visible",i<=E&&(t.style.right=`${b}px`)},A=(t,o)=>{const e=w(o);if(!e)return;const i=k(t,o);s();const{popup:r,overlay:a}=y(e,i);document.body.appendChild(a),n={anchor:t,popup:r,overlay:a},h(r,t),document.addEventListener("keydown",u),window.addEventListener("resize",g),window.addEventListener("scroll",g,!0),(r.querySelector("button")||r).focus({preventScroll:!0})},T=()=>{document.addEventListener("click",t=>{if(t.metaKey||t.ctrlKey||t.shiftKey||t.button===1)return;const o=t.target.closest("sup a[href], a.footnote-ref[href]");if(!o)return;const e=d(o.getAttribute("href")||"");!e||!(document.querySelector(`p.footnote#${c(e)}`)||document.getElementById(e))||(t.preventDefault(),A(o,e))})},q=()=>{const t=m("div.footnotes"),o=m("#footnotes-toggle");if(!o||!t)return;t.classList.add("hidden"),o.setAttribute("role","button"),o.setAttribute("tabindex","0"),o.setAttribute("aria-expanded","false");let e=m(".footnotes-toggle-chevron",o);e?e.style.transform="rotate(-90deg)":(e=document.createElement("img"),e.className="footnotes-toggle-chevron",e.src="/wp-content/themes/cigno-zen/assets/images/chevron-down.svg",e.width="32",e.height="32",e.alt="",e.setAttribute("aria-hidden","true"),e.style.transform="rotate(-90deg)",e.style.marginLeft="0.5rem",o.appendChild(e));const i=r=>{o.setAttribute("aria-expanded",r?"true":"false"),r?(t.classList.remove("hidden"),e.style.transform=""):(t.classList.add("hidden"),e.style.transform="rotate(-90deg)")};o.addEventListener("click",()=>i(t.classList.contains("hidden"))),o.addEventListener("keydown",r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),i(t.classList.contains("hidden")))})},C=()=>{q(),T()};document.readyState!=="loading"?C():document.addEventListener("DOMContentLoaded",C)})(),function(){var v="cz-theme",m=document.documentElement,c=document.getElementById("theme-toggle");if(!c)return;function d(n){m.setAttribute("data-theme",n);try{localStorage.setItem(v,n)}catch{}c.setAttribute("aria-pressed",n==="dark")}var p=localStorage.getItem(v);if(p)d(p);else{var L=window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches;d(L?"light":"dark")}var w=720,k;c.addEventListener("click",function(){if(!c.classList.contains("animating")){var n=m.getAttribute("data-theme")||"dark",s=n==="dark"?"light":"dark",u=s==="dark"?"anim-to-dark":"anim-to-light";c.classList.add("animating",u),requestAnimationFrame(function(){d(s),clearTimeout(k),k=setTimeout(function(){c.classList.remove("animating","anim-to-dark","anim-to-light")},w)})}})}();
//# sourceMappingURL=script.min.js.map
